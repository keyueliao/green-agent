#!/bin/bash
set -e

# æ°¸è¿œä»Žä»“åº“æ ¹ç›®å½•å¯åŠ¨ï¼ˆå¾ˆé‡è¦ï¼‰
cd /Users/liaokeyue/agentbeats-new

# ç›´æŽ¥æŒ‡å‘ appworld è™šæ‹ŸçŽ¯å¢ƒé‡Œçš„ appworld å¯æ‰§è¡Œæ–‡ä»¶
APPWORLD_BIN="/Users/liaokeyue/miniconda3/envs/appworld/bin/appworld"

mkdir -p logs

echo "ðŸš€ [1/4] Starting AppWorld APIs on port 9000 (with setup)..."
"$APPWORLD_BIN" serve apis \
  --port 9000 \
  --with-setup \
  > logs/apis.log 2>&1 &
PID_APIS=$!

echo "ðŸŒ [2/4] Starting AppWorld environment on port 8000 (with setup)..."
"$APPWORLD_BIN" serve environment \
  --port 8000 \
  --with-setup \
  > logs/environment.log 2>&1 &
PID_ENV=$!

echo "ðŸ”Œ [3/4] Starting MCP server on port 10000 (with setup)..."
"$APPWORLD_BIN" serve mcp http \
  --remote-apis-url http://localhost:9000 \
  --app-names supervisor,amazon,spotify,gmail,phone,venmo,splitwise,simple_note,todoist,file_system \
  --port 10000 \
  --with-setup \
  > logs/mcp.log 2>&1 &
PID_MCP=$!

# ç»™çŽ¯å¢ƒä¸€ç‚¹æ—¶é—´å¯åŠ¨
sleep 3

echo "ðŸ¤– [4/4] Starting GREEN agent via AgentBeats v2..."
# ä¸å†åˆ‡ conda çŽ¯å¢ƒï¼Œæ‰€ä»¥ uv ä»ç„¶åœ¨ PATH é‡Œ
uv run agentbeats-run scenarios/appworld/scenario.toml --serve-only
AGENT_EXIT_CODE=$?

echo "ðŸ›‘ Green agent exited with code $AGENT_EXIT_CODE. Cleaning up AppWorld servers..."
kill $PID_APIS $PID_ENV $PID_MCP 2>/dev/null || true

exit $AGENT_EXIT_CODE
#!/bin/bash
set -e

# æ°¸è¿œä»Žä»“åº“æ ¹ç›®å½•å¯åŠ¨ï¼ˆå¾ˆé‡è¦ï¼‰
cd /Users/liaokeyue/agentbeats-new

# ç›´æŽ¥æŒ‡å‘ appworld è™šæ‹ŸçŽ¯å¢ƒé‡Œçš„ appworld å¯æ‰§è¡Œæ–‡ä»¶
APPWORLD_BIN="/Users/liaokeyue/miniconda3/envs/appworld/bin/appworld"

mkdir -p logs

echo "ðŸš€ [1/4] Starting AppWorld APIs on port 9000 (with setup)..."
"$APPWORLD_BIN" serve apis \
  --port 9000 \
  --with-setup \
  > logs/apis.log 2>&1 &
PID_APIS=$!

echo "ðŸŒ [2/4] Starting AppWorld environment on port 8000 (with setup)..."
"$APPWORLD_BIN" serve environment \
  --port 8000 \
  --with-setup \
  > logs/environment.log 2>&1 &
PID_ENV=$!

echo "ðŸ”Œ [3/4] Starting MCP server on port 10000 (with setup)..."
"$APPWORLD_BIN" serve mcp http \
  --remote-apis-url http://localhost:9000 \
  --app-names supervisor,amazon,spotify,gmail,phone,venmo,splitwise,simple_note,todoist,file_system \
  --port 10000 \
  --with-setup \
  > logs/mcp.log 2>&1 &
PID_MCP=$!

# ç»™çŽ¯å¢ƒä¸€ç‚¹æ—¶é—´å¯åŠ¨
sleep 3

echo "ðŸ¤– [4/4] Starting GREEN agent via AgentBeats v2..."
# ä¸å†åˆ‡ conda çŽ¯å¢ƒï¼Œæ‰€ä»¥ uv ä»ç„¶åœ¨ PATH é‡Œ
uv run agentbeats-run scenarios/appworld/scenario.toml --serve-only
AGENT_EXIT_CODE=$?

echo "ðŸ›‘ Green agent exited with code $AGENT_EXIT_CODE. Cleaning up AppWorld servers..."
kill $PID_APIS $PID_ENV $PID_MCP 2>/dev/null || true

exit $AGENT_EXIT_CODE
#!/bin/bash
set -e

# æ°¸è¿œä»Žä»“åº“æ ¹ç›®å½•å¯åŠ¨ï¼ˆå¾ˆé‡è¦ï¼‰
cd /Users/liaokeyue/agentbeats-new

echo "ðŸ”„ Activating appworld conda environment..."
source /Users/liaokeyue/miniconda3/bin/activate appworld

mkdir -p logs

echo "ðŸš€ [1/4] Starting AppWorld APIs on port 9000 (with setup)..."
appworld serve apis \
  --port 9000 \
  --with-setup \
  > logs/apis.log 2>&1 &
PID_APIS=$!

echo "ðŸŒ [2/4] Starting AppWorld environment on port 8000 (with setup)..."
appworld serve environment \
  --port 8000 \
  --with-setup \
  > logs/environment.log 2>&1 &
PID_ENV=$!

echo "ðŸ”Œ [3/4] Starting MCP server on port 10000 (with setup)..."
appworld serve mcp http \
  --remote-apis-url http://localhost:9000 \
  --app-names supervisor,amazon,spotify,gmail,phone,venmo,splitwise,simple_note,todoist,file_system \
  --port 10000 \
  --with-setup \
  > logs/mcp.log 2>&1 &
PID_MCP=$!

# ç»™çŽ¯å¢ƒä¸€ç‚¹æ—¶é—´å¯åŠ¨
sleep 3

echo "ðŸ¤– [4/4] Starting GREEN agent via AgentBeats v2..."
# ç”¨ uv è·‘ agentbeats v2 çš„ scenarioï¼ˆè€Œä¸æ˜¯æ—§çš„ run_agentï¼‰
uv run agentbeats-run scenarios/appworld/scenario.toml --serve-only
AGENT_EXIT_CODE=$?

echo "ðŸ›‘ Green agent exited with code $AGENT_EXIT_CODE. Cleaning up AppWorld servers..."
kill $PID_APIS $PID_ENV $PID_MCP 2>/dev/null || true

exit $AGENT_EXIT_CODE
